---
title: "Assignment 1"
author: "Udit Pant"
date: 03/09/2019
output:
  pdf_document: default
---
# Climate Change and its Effects

Climate change is the change in earth's climatic conditions that last for a very long time. Due to this change, the estabilished balance of nature is disturbed which causes loss of all life forms. This loss is caused by increased rate of natural disasters, loss of food production, etc. 

## Causes

### Greenhouse gases

CO2 is known to be the most impactful among the identified greenhouse gases. CO2 is emitted both by natural processes and man-made processes. The rising concentrations of this gas is a major concern for the planet. Over the years, CO2 levels have varied in concentrations. However, recently the concentrations (in ppm) have skyrocketted. The plots below reflect the current state of CO2 concentrations in the air which is increasing at an alarming rate.  

&nbsp;

\begin{center}

\large{CO2 Levels Through The Years}

\end{center}
 
```{r, echo=FALSE, results='hide', fig.align="center"}

# Data Source: NASA

co2_levels <- c(190, 260, 180, 240, 170, 260, 210, 255, 190, 250, 185, 290, 185, 300, 185, 280, 200, 260, 180, 290, 180, 310, 410)
years <- c("800,000", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "Present", "Present")

bp1 <- barplot(co2_levels, xlab = "Years Before Today", ylab = "CO2 (in ppm)", names.arg = years, col = c("lightcyan", "red", "lightblue"),)

print(bp1)

```

In the figure below, one can notice the sharp peak in the concentration levels which has gone beyond 400ppm. Due to this, the overall temperatures around the world have increased resulting in the melting of glaciers and ice caps. It further adds to the increased sea-water levels which further ressult in catastrophic tsunamis and floods.  

&nbsp;

\begin{center}

\large{Increasing CO2 Levels}

\end{center}
```{r, echo=FALSE, results='hide', fig.align="center"}

# Data Source: NASA

plt1 <- plot(co2_levels, type = "l", xlab = "Years (in 100s)", ylab = "CO2 (in ppm)", col  = rainbow(25))

print(plt1)

```

***

### The relation between Emissions and Forest Cover

Due to increased use of automobiles, industries and manufacturing plants, not only have the CO2 levels increased but have reached a level which is almost threatening. This sudden increase has also been due to the fact that forest cover around the world has decreased substantially. Trees play a major role in balancing out the excess CO2 from the atmosphere. With rapid deforestation and bad agricultural practices, this has impacted the increase in CO2 levels. 

The heatmap below visualizes the change in CO2 emissions and Forest Area from 1995 to 2010. Data from all countries of the world have been used to plot the figure.  

&nbsp;


```{r, echo=FALSE, results='hide', warning=FALSE, fig.align="center", message=FALSE}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  co2_emissions <- df[df$Indicator.Code %in% c("EN.ATM.CO2E.KT"),]
  
  sliced_co2_emissions <- co2_emissions[c("Country.Name", "X1990", "X1995", "X2000", "X2005", "X2010")]
  
  forest_area <- df[df$Indicator.Code %in% c("AG.LND.FRST.K2"),]
  
  sliced_forest_area <- forest_area[c("Country.Name", "X1990", "X1995", "X2000", "X2005", "X2010", "X2015", "X2016")]
  
  merged_df1 <- merge(sliced_co2_emissions, sliced_forest_area[, 1:6], by="Country.Name")
  
  library(gplots)
  library(RColorBrewer)
  
  labels <- merged_df1[, 1]
  mat_data <- data.matrix(merged_df1[,2:ncol(merged_df1)])
  rownames(mat_data) <- labels
  
  sample_data <- mat_data[sample(nrow(mat_data), 10),]
  
  my_palette <- colorRampPalette(c("red", "yellow", "green"))(n = 299)

  col_breaks = c(seq(-1,0,length=100),
  seq(0.01,0.8,length=100),
  seq(0.81,1,length=100))
  
  hm1 <- heatmap.2(mat_data[, 2:ncol(mat_data)],
  main = "CO2 emissions vs Forest Cover",
  Rowv = FALSE,
  Colv= FALSE)
  
  print(hm1)
  
```

Below is a sample of forest areas in countries across the world. The left portion of the heatmap depicts the increase in CO2 emissions to which the forest covers have decreased or remained more or less the same.  

&nbsp;
```{r, echo=FALSE, results='hide', warning=FALSE, fig.align="center"}
  hm2 <- heatmap.2(sample_data,
  main = "CO2 emissions vs Forest Cover",
  Rowv = FALSE,
  Colv= FALSE)

print(hm2)
```

***

### Agricultural lands and Energy Use

With more and more lands occupied for agriculture and felling of trees for energy production also has caused a lot of change in the environment. We see a postive correlation when comparing agriculture and energy use.    

&nbsp;
```{r, echo=FALSE, results='hide', warning=FALSE, fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  agricultural_land <- df[df$Indicator.Code %in% c("AG.LND.AGRI.K2"),]
  
  sliced_agricultural_land <- agricultural_land[c("Country.Name", "X1990", "X1995", "X2000", "X2005", "X2010")]
  
  energy_use <- df[df$Indicator.Code %in% c("EG.USE.PCAP.KG.OE"),]
  
  sliced_energy_use <- energy_use[c("Country.Name", "X1990", "X1995", "X2000", "X2005", "X2010")]
  
  merged_df2 <- merge(sliced_agricultural_land[, 1:6], sliced_energy_use, by="Country.Name")
  
  library(gplots)
  library(RColorBrewer)
  
  labels <- merged_df2[, 1]
  mat_data <- data.matrix(merged_df2[,2:ncol(merged_df2)])
  rownames(mat_data) <- labels
  
  sample_data <- mat_data[sample(nrow(mat_data), 10),]
  
  my_palette <- colorRampPalette(c("red", "yellow", "green"))(n = 299)

  col_breaks = c(seq(-1,0,length=100),
  seq(0.01,0.8,length=100),
  seq(0.81,1,length=100))
  
  hm3 <- heatmap.2(mat_data[, 2:ncol(mat_data)],
  main = "Agricultural Land vs Energy Use",
  Rowv = FALSE,
  Colv= FALSE)
  
  print(hm3)
  
```
***

## Effects across the Globe:

### India

#### Rise in Temperatures

Greenhouse gases such as CO2 are known to cause an increase in the temperature of the surroundings by trapping heat from the sun. An analysis on recorded data yields some unsettling facts. The data below represents mean temperature of Indian cities from all regions for the month of December (Winter) and June (Summer). On close observation, it can be noticed that on an average, mean temperature in winters are on a decline. Similarly, in summers, the mean temperature are on the rise. This hints at the possible shift of the climatic cycle which could disturb the living conditions in which we live. This has grave consequences such as bad crop yields, affect on animal habitat, etc.  

&nbsp;

\begin{center}

\large{Mean Temperature in December}

\end{center}
```{r, echo=FALSE, results='hide', fig.align="center"}
mean_temp_dec08 = c(5.5, 17.2, 21.5, 20.5, 23.7, 21.7, 22.9, 23.3, 26.2, 27.4)
mean_temp_dec18 = c(3.0, 14.8, 18.3, 19.3, 20.6, 20.3, 19.5, 22.7, 26.3, 28.2)

mean_temp_jun08 = c(23.9, 30.9, 32.5, 29.2, 32.5, 29.5, 30.5, 29.6, 32.4, 27.6)
mean_temp_jun18 = c(21.8, 34.7, 34.5, 29.5, 34.1, 31.3, 30.7, 29.9, 32.9, 27.6)

library(ggplot2)

cities <- c('Srinagar', 'New Delhi', 'Jodhpur', 'Guwahati', 'Ahmedabad', 'Calcutta', 'Nagpur', 'Hyderabad', 'Chennai', 'Thiruvanthapuram', 'Srinagar', 'New Delhi', 'Jodhpur', 'Guwahati', 'Ahmedabad', 'Calcutta', 'Nagpur', 'Hyderabad', 'Chennai', 'Thiruvanthapuram')

year <- c('2008', '2008', '2008', '2008', '2008', '2008', '2008', '2008', '2008', '2008', '2018', '2018', '2018', '2018', '2018', '2018', '2018', '2018', '2018', '2018')

temperature1 <- c(5.5, 17.2, 21.5, 20.5, 23.7, 21.7, 22.9, 23.3, 26.2, 27.4, 3.0, 14.8, 18.3, 19.3, 20.6, 20.3, 19.5, 22.7, 26.3, 28.2)

df1 <- data.frame(year, cities, temperature1)

temperature2 <- c(23.9, 30.9, 32.5, 29.2, 32.5, 29.5, 30.5, 29.6, 32.4, 27.6, 21.8, 34.7, 34.5, 29.5, 34.1, 31.3, 30.7, 29.9, 32.9, 27.6)

df2 <- data.frame(year, cities, temperature2)

gplt1 <- ggplot(df1, aes(cities, temperature1, fill = year)) +  geom_bar(stat="identity", position = "dodge") +  scale_fill_brewer(palette = "Set1") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Cities") + ylab("Temperature")

print(gplt1)

```

&nbsp;
&nbsp;

\begin{center}

\large{Mean Temperature in June}

\end{center}
```{r, echo=FALSE, results='hide', fig.align="center"}
gplt2 <- ggplot(df2, aes(cities, temperature2, fill = year)) + geom_bar(stat="identity", position = "dodge") +  scale_fill_brewer(palette = "Set1") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Cities") + ylab("Temperature")

print(gplt2)
```
***

#### Disturbance in Precipitation Levels:

The plots below reveal that in just the last ten years rainfall patterns have changed drastically. During winters, coastal areas such as Chennai show a massive increase in rainfall. On the contrary, places like Srinagar are seeing a huge decline in the amount of rainfall received. During summers, in general there has been a decline in the amount of rainfall received.  

&nbsp;

\begin{center}

\large{Rainfall in December (in mm)}

\end{center}
```{r, echo=FALSE, results='hide', fig.align="center"}

cities <- c('Srinagar', 'New Delhi', 'Jodhpur', 'Guwahati', 'Ahmedabad', 'Calcutta', 'Nagpur', 'Hyderabad', 'Chennai', 'Thiruvanthapuram', 'Srinagar', 'New Delhi', 'Jodhpur', 'Guwahati', 'Ahmedabad', 'Calcutta', 'Nagpur', 'Hyderabad', 'Chennai', 'Thiruvanthapuram')

year <- c('2008', '2008', '2008', '2008', '2008', '2008', '2008', '2008', '2008', '2008', '2018', '2018', '2018', '2018', '2018', '2018', '2018', '2018', '2018', '2018')

mean_rainfall_dec08 = c(60, 6, 2, 5, 0, 0, 0, 0, 8, 77)
mean_rainfall_dec18 = c(2, 18, 0, 23, 0, 9, 8, 48, 93, 2)

mean_rainfall_jun08 = c(25, 91, 132, 319, 21, 559, 205, 40, 57, 102)
mean_rainfall_jun18 = c(61, 40, 49, 259, 8, 420, 356, 101, 49, 94)

rainfall1 <- c(60, 6, 2, 5, 0, 0, 0, 0, 8, 77, 2, 18, 0, 23, 0, 9, 8, 48, 93, 2)

df1 <- data.frame(year, cities, rainfall1)

rainfall2 <- c(25, 91, 132, 319, 21, 559, 205, 40, 57, 102, 61, 40, 49, 259, 8, 420, 356, 101, 49, 94)

df2 <- data.frame(year, cities, rainfall2)

# par(mar = c(6.5, 6.5, 0.5, 0.5), mgp = c(5, 1, 0))

gplt3 <- ggplot(df1, aes(cities, rainfall1, fill = year)) +  geom_bar(stat="identity", position = "dodge") +  scale_fill_brewer(palette = "Set1") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Cities") + ylab("Rainfall (mm)")

print(gplt3)

```
***

&nbsp;

\begin{center}

\large{Rainfall in June (in mm)}

\end{center}
```{r, echo=FALSE, results='hide', fig.align="center"}
gplt4 <- ggplot(df2, aes(cities, rainfall2, fill = year)) + geom_bar(stat="identity", position = "dodge") +  scale_fill_brewer(palette = "Set1") + theme(plot.title = element_text(hjust = 0.5)) + xlab("Cities") + ylab("Rainfall (mm)")

print(gplt4)
```


***

## Across the Globe

### Droughts Across the World

One of the examples of extreme weather conditions caused due to climate imbalance are droughts. From the graph below, it is evident that the number of occurrences have increased at an alarming rate.  

&nbsp;

\begin{center}

\large{Droughts across the world}

\end{center}

```{r, echo=FALSE, results='hide', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/number-of-natural-disaster-events.csv'
  disasters <- read.csv(abs_path, sep = ",", header = TRUE)
  
  drought <- disasters[disasters$Entity %in% c("Drought"),]
  
  flood <- disasters[disasters$Entity %in% c("Flood"),]
  
  bplt2 <- barplot(drought$Number.of.reported.natural.disasters..reported.disasters., names.arg = drought$Year, xlab = "Year", ylab = "# of Droughts", col = c("lightcyan", "red", "lightblue"),)
  
  print(bplt2)

```


***

### Devastating Floods

The other terrible situations to arise from bad climatic conditions is that of floods. Duw to increased temperatures, the ice at the glaciers melts away contributing to the increased sea levels. Extreme weather patterns caused due to climatic shifts cause unprecedented rainfalls which result in overflowing of river basins causing nearby areas to flood causing disease and loss of life.    

&nbsp;

\begin{center}

\large{Floods across the world}

\end{center}

```{r, echo=FALSE, results='hide', fig.align="center"}
bplt3 <- barplot(flood$Number.of.reported.natural.disasters..reported.disasters., names.arg = flood$Year, xlab = "Year", ylab = "# of Floods", col = c("lightcyan", "red", "lightblue"),)

print(bplt3)

```

### Terrestrial and Marine Cover through the years

Successively, through the years, terrestrial and marine cover has decreased. As it can be observed below, the areas have become more scattered and less voluminous.  

&nbsp;

\begin{center}

\large{Terrestrial and Marine Cover}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  terrestrial_marine <- df[df$Indicator.Code %in% c("ER.PTD.TOTL.ZS"),]
  
  sliced_terrestrial_marine <- terrestrial_marine[c("Country.Name", "X2016", "X2017", "X2018")]
  
  par(mfrow = c(1, 3))
  plot(sliced_terrestrial_marine[c("Country.Name", "X2016")])
  plot(sliced_terrestrial_marine[c("Country.Name", "X2017")])
  plot(sliced_terrestrial_marine[c("Country.Name", "X2018")])
  
```


***

### Agricultural Patterns across the world

On observing acrgricultural patterns in a decadal fashion, the growing trend of agriculture can be observed which sounds promising but isn't. Lands for agriculture are acquired often through deforestation. Often the agricultural practices are not sustainaible and cause damage to the environment.  

&nbsp;

\begin{center}

\large{Agricultural Land Cover}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  sliced_agricultural_land <- agricultural_land[c("Country.Name", "X1961", "X1971", "X1981", "X1991", "X2001", "X2011", "X2016")]
  
  par(mfrow = c(2, 3))
  plot(sliced_agricultural_land[c("Country.Name", "X1971")])
  plot(sliced_agricultural_land[c("Country.Name", "X1981")])
  plot(sliced_agricultural_land[c("Country.Name", "X1991")])
  plot(sliced_agricultural_land[c("Country.Name", "X2001")])
  plot(sliced_agricultural_land[c("Country.Name", "X2011")])
  plot(sliced_agricultural_land[c("Country.Name", "X2016")])
  
```

***

### Decline in Forest Area

As a result of urbanization and industrialization, the total forest cover across the globe has significantly reduced. This affects the gas levels in the atmosphere and also results in animals losing their habitat; some of them edging towards extinction.  

&nbsp;
\begin{center}

\large{Forest Cover}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  par(mfrow = c(2, 3))
  plot(sliced_forest_area[c("Country.Name", "X1995")])
  plot(sliced_forest_area[c("Country.Name", "X2000")])
  plot(sliced_forest_area[c("Country.Name", "X2005")])
  plot(sliced_forest_area[c("Country.Name", "X2010")])
  plot(sliced_forest_area[c("Country.Name", "X2015")])
  plot(sliced_forest_area[c("Country.Name", "X2016")])
  
```
***

### Increased CO2 emissions

CO2 emissions are on the rise throughout the world. This has resulted in increase in the average global temperature of the planet causing melting os galciers, rise in sea level and disturbances in air currents.  

&nbsp;
\begin{center}

\large{CO2 Emissions}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  sliced_co2_emissions <- co2_emissions[c("Country.Name", "X1990", "X1995", "X2000", "X2005", "X2010", "X2015", "X2016")]
  
  par(mfrow = c(2, 2))
  plot(sliced_co2_emissions[c("Country.Name", "X1995")])
  plot(sliced_co2_emissions[c("Country.Name", "X2000")])
  plot(sliced_co2_emissions[c("Country.Name", "X2005")])
  plot(sliced_co2_emissions[c("Country.Name", "X2010")])
  
```

***

### Increased Energy Use 

Greater use of energy is a consequence of unrestricted occupation of forest cover by humans. Burning of fossil fuels not only causes pollution but also contributes to emission of greenhouse gases.  

&nbsp;
\begin{center}

\large{Energy Use}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  sliced_energy_use <- energy_use[c("Country.Name", "X1995", "X2000", "X2005", "X2010", "X2015", "X2016")]
  
  par(mfrow = c(2, 2))
  plot(sliced_energy_use[c("Country.Name", "X1995")])
  plot(sliced_energy_use[c("Country.Name", "X2000")])
  plot(sliced_energy_use[c("Country.Name", "X2005")])
  plot(sliced_energy_use[c("Country.Name", "X2010")])
  
```

***

### Increased Methane Emissions

Methane, like CO2, is an active player in the greenhouse effect. Although, not so much in effect as CO2, however, its sources of emission are automobiles which have grown humongously.  

&nbsp;
\begin{center}

\large{Methane Emissions}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  methane_emissions <- df[df$Indicator.Code %in% c("EN.ATM.METH.KT.CE"),]
  
  sliced_methane_emissions <- methane_emissions[c("Country.Name", "X1995", "X2000", "X2005", "X2010", "X2015", "X2016")]
  
  par(mfrow = c(2, 2))
  plot(sliced_methane_emissions[c("Country.Name", "X1995")])
  plot(sliced_methane_emissions[c("Country.Name", "X2000")])
  plot(sliced_methane_emissions[c("Country.Name", "X2005")])
  plot(sliced_methane_emissions[c("Country.Name", "X2010")])
  
```


***

### Increased Nitrous Oxide Emissions

Nitrous Oxide not only acts as a greenhouse gas but also causes damage to the ozone layer which is our only protection from the harmful rays of the sun. Nitrous Oxide also causes damage to human respiratory systems.  

&nbsp;
\begin{center}

\large{Nitrous Oxide Emissions}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  no_emissions <- df[df$Indicator.Code %in% c("EN.ATM.NOXE.KT.CE"),]
  
  sliced_no_emissions <- no_emissions[c("Country.Name", "X1995", "X2000", "X2005", "X2010", "X2015", "X2016")]
  
  par(mfrow = c(2, 2))
  plot(sliced_no_emissions[c("Country.Name", "X1995")])
  plot(sliced_no_emissions[c("Country.Name", "X2000")])
  plot(sliced_no_emissions[c("Country.Name", "X2005")])
  plot(sliced_no_emissions[c("Country.Name", "X2010")])
  
  
```

***

### Impact of other Greenhouse Gases

&nbsp;
\begin{center}

\large{Other Greenhouse Gas Emissions}

\end{center}
```{r, echo=FALSE, results='asis', fig.align="center"}
  abs_path = '/home/uditp/Documents/Sem3/DSc/Assignments/Assignment 1/Data/CLimate Change (World)/new.csv'
  df <- read.csv(abs_path, sep = ",", header = TRUE)
  
  ggas_emissions <- df[df$Indicator.Code %in% c("EN.ATM.GHGT.KT.CE"),]
  
  sliced_ggas_emissions <- ggas_emissions[c("Country.Name", "X1995", "X2000", "X2005", "X2010", "X2015", "X2016")]
  
  par(mfrow = c(2, 2))
  plot(ggas_emissions[c("Country.Name", "X1995")])
  plot(ggas_emissions[c("Country.Name", "X2000")])
  plot(ggas_emissions[c("Country.Name", "X2005")])
  plot(ggas_emissions[c("Country.Name", "X2010")])
  
```


## References

1. [India - Climate Data](https://www.library.noaa.gov/Collections/Digital-Docs/Foreign-Climate-Data/India-Climate-Data)
2. [Monthly Climatic Data of the World](https://www.ncdc.noaa.gov/IPS/mcdw/mcdw.html)
3. [India - Monthly Rainfall Data](https://www.indiastat.com/meteorological-data-data/22/rainfall/238/meteorological-sub-division-wise-monthly-rainfall-2000-2019/722489/stats.aspx)
4. [Global Climate Summary](https://www.ncei.noaa.gov/metadata/geoportal/rest/metadata/item/gov.noaa.ncdc:C00947/html)
5. [Natural Disasters](https://ourworldindata.org/natural-disasters)
6. [NASA - Global climate change](https://climate.nasa.gov/)
